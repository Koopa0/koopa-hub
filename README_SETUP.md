# Koopa Hub - Setup & Development Guide

## Prerequisites

- Flutter 3.38+ (includes Dart 3.10+)
- Chrome (for web development)

## First Time Setup

Run the setup script to generate all necessary code files:

```bash
./setup.sh
```

This script will:
1. Install dependencies (`flutter pub get`)
2. Generate localization files (`flutter gen-l10n`)
3. Generate Riverpod provider code (`dart run build_runner build`)

## Development

### Web Development

Run the app on Chrome with automatic code generation:

```bash
./run_web.sh
```

### Desktop/Mobile Development

```bash
flutter run
```

## Manual Code Generation

If you need to regenerate code manually:

### Localization Files

```bash
flutter gen-l10n
```

Generated files location: `.dart_tool/flutter_gen/gen_l10n/`

### Riverpod Provider Code

```bash
dart run build_runner build --delete-conflicting-outputs
```

Generated files: `*.g.dart` files next to your `@riverpod` annotated providers

### Watch Mode (Auto-regenerate on changes)

```bash
dart run build_runner watch --delete-conflicting-outputs
```

## Troubleshooting

### "Couldn't resolve the package 'flutter_gen'"

**Solution:** Run `flutter gen-l10n` to generate localization files.

### "Type 'XxxRef' not found" or "wrote 0 outputs"

**Solution:**
1. Clean the build cache: `flutter clean`
2. Reinstall dependencies: `flutter pub get`
3. Run setup script: `./setup.sh`

### "The getter 'valueOrNull' isn't defined"

This has been fixed - ensure you're on the latest commit that uses `hasValue`/`requireValue` pattern.

## Project Structure

```
lib/
├── core/
│   └── constants/
│       └── design_tokens.dart          # Design system constants
├── features/
│   ├── chat/
│   │   ├── models/
│   │   ├── providers/
│   │   │   └── chat_provider.dart      # @riverpod providers
│   │   └── widgets/
│   ├── knowledge/
│   │   └── providers/
│   │       └── knowledge_provider.dart # @riverpod providers
│   └── settings/
│       └── providers/
│           └── settings_provider.dart  # @riverpod providers
└── l10n/
    ├── app_en.arb                      # English translations
    ├── app_zh.arb                      # Chinese (Traditional) translations
    └── app_zh_TW.arb                   # Taiwan Chinese translations

.dart_tool/flutter_gen/gen_l10n/       # Generated l10n files (not committed)
```

## Best Practices Applied

This project follows Flutter 3.38 and Dart 3.10 best practices:

- ✅ Riverpod 3.0 with code generation (`@riverpod` annotations)
- ✅ Material Design 3 ColorScheme (no hardcoded colors)
- ✅ Flutter l10n for internationalization
- ✅ Design tokens system (8dp grid, consistent spacing)
- ✅ AsyncNotifier pattern for async state management
- ✅ Record types for data models (Dart 3.0+ feature)
- ✅ Proper error handling with AsyncValue.guard()

## Code Generation Files

Files with these patterns are auto-generated and should NOT be edited manually:

- `*.g.dart` - Generated by build_runner/riverpod_generator
- `.dart_tool/flutter_gen/` - Generated by flutter gen-l10n

These files are listed in `.gitignore` and must be regenerated on each machine.
